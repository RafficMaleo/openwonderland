<project basedir="." default="..." name="core.setup">
    <!-- set the build-scripts directory to the current directory -->
    <dirname property="core.build-scripts.dir" file="${ant.file.core.setup}"/>
    <property name="core.dir" location="${core.build-scripts.dir}/../.."/>
    <property name="top.dir" location="${core.dir}/.."/>
    
    <!-- import the main setup file -->
    <import file="${top.dir}/build-tools/build-scripts/setup.xml"/>
    
    <!-- import core properties -->
    <property file="${core.build-scripts.dir}/core.properties"/>
    
    <!-- import core classpath -->
    <import file="${core.build-scripts.dir}/classpath.xml"/>
    
    <!-- unpack zips -->
    <target name="unpack-core-libs" depends="unpack-jbullet">
        <!-- darkstar -->
   	<unpack-lib-zip pkgname="sgs-server"
			srcdir="${core.lib.zip.dir}" destdir="${core.sgs.dir}"/>
	<unpack-lib-zip pkgname="sgs-client"
			srcdir="${core.lib.zip.dir}" destdir="${core.sgs.dir}"/>
                         
        <!-- jogl -->
        <unpack-lib-zip pkgname="jogl"
                        srcdir="${core.lib.zip.os.dir}" destdir="${core.lib.os.dir}/.."/>
    </target>

    <target name="unpack-jbullet">
        <if>
            <not>
            <available file="${core.lib.dir}/common/jbullet.jar"/>
            </not>
            <then>
                <get src="http://jbullet.advel.cz/download/jbullet-20080917.zip" dest="${core.lib.dir}/jbullet.zip"/>
                <unzip src="${core.lib.dir}/jbullet.zip" dest="${core.lib.dir}" overwrite="true">
                    <patternset>
                        <include name="**/jbullet.jar"/>
                    </patternset>
                    <mapper type="flatten"/>
                </unzip>
                <move file="${core.lib.dir}/jbullet.jar" todir="${core.lib.dir}/common"/>
                <delete file="jbullet.zip" quiet="true"/>
            </then>
        </if>
    </target>

    <target name="-core-scrub-libs" depends="clean-jbullet, clean-core-libs"/>

    <target name="clean-jbullet">
       <delete file="${core.lib.dir}/common/jbullet.jar" quiet="true"/>
    </target>
   
    <target name="clean-core-libs" description="Clean external libraries" depends="clean-jbullet">
        <delete dir="core.sgs.dir"/>
        <delete dir="core.lib.os.dir"/>
    </target>    
</project>
