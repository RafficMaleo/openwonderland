<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<domain application-root="${com.sun.aas.instanceRoot}/applications" log-root="${com.sun.aas.instanceRoot}/logs">
    <system-applications/>
    <applications/>
    <resources>
        <jdbc-connection-pool datasource-classname="org.apache.derby.jdbc.EmbeddedDataSource" name="userpool">
            <property name="databaseName" value="${com.sun.aas.instanceRoot}/userdb"/>
            <property name="connectionAttributes" value=";create=true"/>
        </jdbc-connection-pool>
        <jdbc-resource jndi-name="jdbc/userpool" pool-name="userpool"/>
        
        <jdbc-connection-pool datasource-classname="org.apache.derby.jdbc.EmbeddedDataSource" name="wonderlandpool">
            <property name="databaseName" value="${wonderland.run.dir}/wonderlanddb"/>
            <property name="connectionAttributes" value=";create=true"/>
        </jdbc-connection-pool>
        <jdbc-resource jndi-name="jdbc/wonderlanddb" pool-name="wonderlandpool"/>
    </resources>
    <servers>
        <server config-ref="server-config" name="server">
            <resource-ref enabled="true" ref="jdbc/__default"/>
        </server>
    </servers>
    <configs>
        <config name="server-config">
            <http-service>
                <access-log format="%client.name% %auth-user-name% %datetime% %request% %status% %response.length%" rotation-enabled="true" rotation-interval-in-minutes="15" rotation-policy="time" rotation-suffix="yyyy-MM-dd"/>
                <request-processing header-buffer-length-in-bytes="8192" initial-thread-count="2" request-timeout-in-seconds="30" thread-count="20" thread-increment="1"/>
                <keep-alive max-connections="250" thread-count="1" timeout-in-seconds="30"/>
                <http-protocol default-response-type="text/plain; charset=iso-8859-1" dns-lookup-enabled="false" forced-response-type="text/plain; charset=iso-8859-1" ssl-enabled="true" version="HTTP/1.1"/>
                <http-file-cache file-caching-enabled="false" file-transmission-enabled="false" globally-enabled="false" hash-init-size="0" max-age-in-seconds="30" max-files-count="1024" medium-file-size-limit-in-bytes="537600" medium-file-space-in-bytes="10485760" small-file-size-limit-in-bytes="2048" small-file-space-in-bytes="1048576"/>
                <connection-pool max-pending-count="4096" queue-size-in-bytes="4096" receive-buffer-size-in-bytes="4096" send-buffer-size-in-bytes="8192"/>
                <http-listener address="0.0.0.0" default-virtual-server="server" enabled="true" id="http-listener-1" port="${wonderland.webserver.port}" server-name=""/>
                <virtual-server hosts="${wonderland.webserver.host}" http-listeners="http-listener-1" id="server" log-file="">
                    <property name="docroot" value="${org.jdesktop.wonderland.docRoot}"/>
                </virtual-server>
            </http-service>
            <thread-pools>
                <thread-pool idle-thread-timeout-in-seconds="120" max-thread-pool-size="200" min-thread-pool-size="0" num-work-queues="1" thread-pool-id="thread-pool-1"/>
            </thread-pools>
            <transaction-service automatic-recovery="false" heuristic-decision="rollback" keypoint-interval="2048" retry-timeout-in-seconds="600" timeout-in-seconds="0" tx-log-dir="${com.sun.aas.instanceRoot}/logs"/>
            <admin-service system-jmx-connector-name="system" type="das-and-server">
     <!-- The JSR 160 "system-jmx-connector" -->
                <!--
                <jmx-connector accept-all="false" address="0.0.0.0" auth-realm-name="admin-realm" enabled="true" name="system" port="8686" protocol="rmi_jrmp" security-enabled="false"/>
                -->
     <!-- The JSR 160 "system-jmx-connector" -->
                <das-config admin-session-timeout-in-minutes="60" autodeploy-dir="${com.sun.aas.instanceRoot}/autodeploy" autodeploy-enabled="true" autodeploy-jsp-precompilation-enabled="false" autodeploy-polling-interval-in-seconds="2" autodeploy-verifier-enabled="false" deploy-xml-validation="full" dynamic-reload-enabled="true" dynamic-reload-poll-interval-in-seconds="2"/>
                <property name="adminConsoleContextRoot" value="/admin"/>
                <property name="adminConsoleDownloadLocation" value="http://download.java.net/glassfish/v3-tp2/admingui/gfv3-preview2-final-admingui.war"/>
       <!-- change this to reflect the correct final download location -->
                <property name="adminConsoleFolder" value="${com.sun.aas.installRoot}/lib/install/applications"/>
                <jmx-connector accept-all="false" address="0.0.0.0" auth-realm-name="admin-realm" enabled="true" name="system" port="8686" protocol="rmi_jrmp" security-enabled="false"/>
            </admin-service>
            <web-container>
                <session-config>
                    <session-manager>
                        <manager-properties/>
                        <store-properties/>
                    </session-manager>
                    <session-properties/>
                </session-config>
            </web-container>
            <security-service>
                <jacc-provider name="default" policy-configuration-factory-provider="com.sun.enterprise.security.provider.PolicyConfigurationFactoryImpl" policy-provider="com.sun.enterprise.security.provider.PolicyWrapper">
                    <property name="repository" value="${com.sun.aas.instanceRoot}/generated/policy"/>
                </jacc-provider>
                <jacc-provider name="simple" policy-configuration-factory-provider="com.sun.enterprise.security.jacc.provider.SimplePolicyConfigurationFactory" policy-provider="com.sun.enterprise.security.jacc.provider.SimplePolicyProvider"/>

                <message-security-config auth-layer="HttpServlet">
                    <provider-config provider-type="server" provider-id="WonderSAM" class-name="org.jdesktop.wonderland.modules.security.weblib.serverauthmodule.WonderSAM">
                        <property name="session.resolver.class" value="org.jdesktop.wonderland.modules.securitysession.weblib.SessionResolverImpl"/>
                        <property name="group.resolver.class" value="org.jdesktop.wonderland.modules.securitygroups.weblib.DBGroupResolverImpl"/>
                    </provider-config>
                </message-security-config>
            </security-service>
            <java-config>
            </java-config>
        </config>
    </configs>
    <property name="administrative.domain.name" value="domain1"/>
</domain>